{"version":3,"file":"Query.js","names":["dotenv","config","SECRET_KEY","process","env","Query","hello","users","_","args","UserModel","find","allUsers","map","user","id","_id","username","age","GraphQLYogaError","books","BookModel","token","console","log","verify","decode","author","allBooks","book","title","numOfPages"],"sources":["../../../src/graphql/resolvers/Query.js"],"sourcesContent":["import { GraphQLYogaError } from '@graphql-yoga/node';\r\nimport { verify } from 'jsonwebtoken';\r\nimport * as dotenv from 'dotenv';\r\ndotenv.config()\r\nconst { SECRET_KEY } = process.env;\r\n\r\nconst Query = {\r\n    hello: () => \"World\",\r\n    users: async (_, args, { UserModel }) => {\r\n        try {\r\n            const allUsers = await UserModel.find()\r\n            return allUsers.map(user => {\r\n                return {\r\n                    id: user._id,\r\n                    username: user.username,\r\n                    age: user.age\r\n                }\r\n            })\r\n        } catch (err) {\r\n            throw new GraphQLYogaError(err)\r\n        }\r\n    },\r\n    books: async (_, args, { UserModel, BookModel, token }) => {\r\n        console.log(\"Token : \", token);\r\n        if (!token) {\r\n            throw new GraphQLYogaError(\"Login Required\")\r\n        }\r\n        try {\r\n            const decode = await verify(token, SECRET_KEY)\r\n            const allBooks = await BookModel.find({ author: decode.id });\r\n            return allBooks.map(book => {\r\n                return {\r\n                    id: book._id,\r\n                    title: book.title,\r\n                    numOfPages: book.numOfPages\r\n                }\r\n            });\r\n        } catch (err) {\r\n            throw new GraphQLYogaError(err)\r\n        }\r\n    }\r\n}\r\n\r\nexport { Query }"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;;;;;+CADA,oJ;;;;;;AAEAA,MAAM,CAACC,MAAP;AACA,IAAQC,UAAR,GAAuBC,OAAO,CAACC,GAA/B,CAAQF,UAAR;AAEA,IAAMG,KAAK,GAAG;EACVC,KAAK,EAAE;IAAA,OAAM,OAAN;EAAA,CADG;EAEVC,KAAK;IAAA,wEAAE,iBAAOC,CAAP,EAAUC,IAAV;MAAA;MAAA;QAAA;UAAA;YAAA;cAAkBC,SAAlB,QAAkBA,SAAlB;cAAA;cAAA;cAAA,OAEwBA,SAAS,CAACC,IAAV,EAFxB;;YAAA;cAEOC,QAFP;cAAA,iCAGQA,QAAQ,CAACC,GAAT,CAAa,UAAAC,IAAI,EAAI;gBACxB,OAAO;kBACHC,EAAE,EAAED,IAAI,CAACE,GADN;kBAEHC,QAAQ,EAAEH,IAAI,CAACG,QAFZ;kBAGHC,GAAG,EAAEJ,IAAI,CAACI;gBAHP,CAAP;cAKH,CANM,CAHR;;YAAA;cAAA;cAAA;cAAA,MAWO,IAAIC,sBAAJ,aAXP;;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CAAF;;IAAA;MAAA;IAAA;;IAAA;EAAA,GAFK;EAgBVC,KAAK;IAAA,wEAAE,kBAAOZ,CAAP,EAAUC,IAAV;MAAA;MAAA;QAAA;UAAA;YAAA;cAAkBC,SAAlB,SAAkBA,SAAlB,EAA6BW,SAA7B,SAA6BA,SAA7B,EAAwCC,KAAxC,SAAwCA,KAAxC;cACHC,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBF,KAAxB;;cADG,IAEEA,KAFF;gBAAA;gBAAA;cAAA;;cAAA,MAGO,IAAIH,sBAAJ,CAAqB,gBAArB,CAHP;;YAAA;cAAA;cAAA;cAAA,OAMsB,IAAAM,oBAAA,EAAOH,KAAP,EAAcpB,UAAd,CANtB;;YAAA;cAMOwB,MANP;cAAA;cAAA,OAOwBL,SAAS,CAACV,IAAV,CAAe;gBAAEgB,MAAM,EAAED,MAAM,CAACX;cAAjB,CAAf,CAPxB;;YAAA;cAOOa,QAPP;cAAA,kCAQQA,QAAQ,CAACf,GAAT,CAAa,UAAAgB,IAAI,EAAI;gBACxB,OAAO;kBACHd,EAAE,EAAEc,IAAI,CAACb,GADN;kBAEHc,KAAK,EAAED,IAAI,CAACC,KAFT;kBAGHC,UAAU,EAAEF,IAAI,CAACE;gBAHd,CAAP;cAKH,CANM,CARR;;YAAA;cAAA;cAAA;cAAA,MAgBO,IAAIZ,sBAAJ,cAhBP;;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CAAF;;IAAA;MAAA;IAAA;;IAAA;EAAA;AAhBK,CAAd"}